{% extends 'base.html' %}

{% block head %}
<title>Sailboat</title>
{% endblock %}

{% block main %}
<style>
.create textarea[name=content] {
  width: 100%;
  max-width: 400px;
  resize: vertical;
}

section {
  margin: 10px 0;
}
</style>

<section>
<h1>{{ profile.display_name }}</h1>
<div>@{{ profile.handle }}</div>
  Following: <a href="/following">{{ follow_count }}</a>
</section>

<section class=newpost>
<h2>Create</h2>
<form action="/posts"
      method=post
      hx-post="/posts"
      hx-swap=outerHTML
      hx-target="section.profile"
      hx-on::after-request="this.reset()">
  <input type=hidden name=profile_id value="{{ profile.profile_id }}">
  <textarea name="content" placeholder="{{ profile.display_name }} is..."></textarea>
  <div><button>Post!</button></div>
</form>
</section>

{% block profile %}
<section class=profile>
<h2>Feed</h2>
{% for post in posts %}
<article class=post>
  <div class=userinfo>
    <address>
      <span class=user>{{ post.display_name }}</span> -
      <span class=handle>{{ post.handle }}</span>
    </address>
    <button class=delete
            hx-delete="/posts/{{ post.post_id }}"
            hx-target="closest article"
            hx-swap="outerHTML"
            hx-confirm="Are you sure you want to delete this post?"
    >Delete
    </button>
    </div>
    <p>{{ post.content }}</p>
    <footer>{{ post.created_at }}</footer>
  </article>
  {% endfor %}
  </section>
{% endblock %}

{% endblock %}
